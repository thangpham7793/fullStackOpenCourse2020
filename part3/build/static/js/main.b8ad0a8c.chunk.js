(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{21:function(e,t,n){e.exports=n(45)},26:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(20),u=n.n(c),o=n(7),l=n(9),i=n(10),s=n(6),f=function(e){var t=e.label,n=e.handleClick,a=e.dataKey;return r.a.createElement("button",{"data-key":a,onClick:n},t)},h=function(e){var t=e.searchPhrase,n=e.persons,a=e.handleDelete;return(t.length?n.filter((function(e){return e.name.toLowerCase().startsWith(t.toLowerCase())})):n).map((function(e,t){return r.a.createElement("li",{key:t},r.a.createElement("p",null,Object.values(e).join(" ")),r.a.createElement(f,{dataKey:e.id,label:"delete",handleClick:a}))}))},d=function(e){var t=e.newSearchPhrase,n=e.handleSearchPhrase;return r.a.createElement("div",null,"filter shown with:",r.a.createElement("input",{value:t,onChange:n}))},m=function(e){var t=e.name,n=e.value,a=e.handleValueChange;return r.a.createElement("div",null,r.a.createElement("label",null,t,": "),r.a.createElement("input",{name:t,value:n,onChange:a}))},p=function(e){var t=e.newValues,n=e.handleSubmit,a=e.handleValueChange,c=Object.keys(t).map((function(e,n){return r.a.createElement(m,{key:n,name:e,value:t[e],handleValueChange:a})}));return r.a.createElement("form",{onSubmit:n},c,r.a.createElement("div",null,r.a.createElement("button",{type:"submit"},"add")))},b=(n(26),function(e){var t=e.message;return 0===t.length?null:t.toLowerCase().includes("error")?r.a.createElement("h2",{className:"error"},t):r.a.createElement("h2",{className:"success"},t)}),v=n(2),g=n.n(v),w=n(4),E=n(5),y=n.n(E),O="/api/persons";function j(){return(j=Object(w.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get(O);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return(k=Object(w.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post(O,t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return(S=Object(w.a)(g.a.mark((function e(t,n){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.put("".concat(O,"/").concat(t),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){return(C=Object(w.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("".concat(O,"/").concat(t)),e.next=3,y.a.delete("".concat(O,"/").concat(t));case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x={getAll:function(){return j.apply(this,arguments)},create:function(e){return k.apply(this,arguments)},update:function(e,t){return S.apply(this,arguments)},remove:function(e){return C.apply(this,arguments)}},A=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],c=t[1],u=Object(a.useState)(""),f=Object(s.a)(u,2),m=f[0],v=f[1],g={name:"",number:""},w=Object(a.useState)(g),E=Object(s.a)(w,2),y=E[0],O=E[1],j=Object(a.useState)(""),k=Object(s.a)(j,2),S=k[0],C=k[1],A=function(e){return function(t){C("".concat(e," ").concat(t)),setTimeout((function(){return C("")}),2e3)}},D=A("Successfully Added"),P=A("Successfully Deleted"),T=A("Successfully Updated"),V=A("There was an error adding"),L=A("There was an error deleting"),N=A("There was an error updating"),K=function(e,t){window.confirm("Already deleted ".concat(e," Do you wish to re-add ").concat(e,"?"))?(C(""),function(e){x.create(e).then((function(t){c([].concat(Object(i.a)(n),[t])),D(e.name),O(g),B()})).catch((function(t){return V(e.name)}))}(t)):(C(""),B())},B=function(){x.getAll().then((function(e){c(e),C("")})).catch((function(e){C("There was an error fetching the data from the server!"),setTimeout((function(){return C("")}),5e3)}))};Object(a.useEffect)((function(){C("Fetching Data"),B()}),[]);return r.a.createElement("div",null,r.a.createElement("h1",null,"UPDATED PHONEBOOK"),r.a.createElement(b,{message:S}),r.a.createElement(d,{newSearchPhrase:m,handleSearchPhrase:function(e){return v(e.target.value)}}),r.a.createElement("h2",null,"New Entry"),r.a.createElement(p,{newValues:y,handleSubmit:function(e){e.preventDefault();var t=Object(l.a)({},y),a=function(e){return e.slice(0).replace(/\W|\d/g,"").toLowerCase()};if(-1===n.findIndex((function(e){var n=e.name;return a(n)===a(t.name)})))!function(e){x.create(e).then((function(t){c([].concat(Object(i.a)(n),[t])),D(e.name),O(g)})).catch((function(t){return V(e.name)}))}(t);else{if(!1===window.confirm("".concat(t.name," has already been added! Replace the old number with a new one?")))return void O(g);var r=n.find((function(e){return e.name===t.name}));x.update(r.id,t).then((function(e){c(n.map((function(t){return t.id===e.id?e:t}))),T(r.name),O(g)})).catch((function(e){404===e.response.status?function(e,t){C("Error: Already deleted ".concat(e)),setTimeout((function(){return K(e,t)}),1e3)}(r.name,t):N(r.name)}))}},handleValueChange:function(e){O(Object(l.a)(Object(l.a)({},y),{},Object(o.a)({},e.target.name,e.target.value)))}}),r.a.createElement("h3",null,"Added"),r.a.createElement("ul",null,0===n.length?r.a.createElement("h4",null,"Fetching Data"):r.a.createElement(h,{persons:n,searchPhrase:m,handleDelete:function(e){console.log(e.target.getAttribute("data-key"));var t=e.target.getAttribute("data-key"),a=n.filter((function(e){return e.id.toString()===t}))[0].name;x.remove(t).then((function(e){c(n.filter((function(e){return e.id.toString()!==t}))),P(a)})).catch((function(e){return L(a)}))}})))};u.a.render(r.a.createElement(A,null),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.b8ad0a8c.chunk.js.map